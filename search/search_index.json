{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 ToDone API Documentation!","text":"<p>\u042d\u0442\u043e\u0442 \u0441\u0430\u0439\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0434\u043b\u044f ToDone API - API \u0434\u043b\u044f \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430 \u0437\u0430\u0434\u0430\u0447.</p>"},{"location":"#_1","title":"\u041e\u0431\u0437\u043e\u0440","text":"<p>ToDone API \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u0438 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0442\u044c, \u043e\u0431\u043d\u043e\u0432\u043b\u044f\u0442\u044c, \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0438 \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438 \u0438\u0445 \u0437\u0430\u0434\u0430\u0447\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 API.</p>"},{"location":"#mainpy","title":"main.py","text":"<pre><code>from fastapi import FastAPI\nfrom connection import *\nfrom routes.task_routes import router as task_router\nfrom routes.user_routes import router as user_router\n\n\napp = FastAPI(\n    title=\"ToDone\",\n    description=\"API \u0434\u043b\u044f \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0430 \u0437\u0430\u0434\u0430\u0447\",\n    version=\"1.0.0\"\n)\n\n@app.on_event(\"startup\")\ndef on_startup():\n    print(\"Initializing database...\")\n    init_db()\n    print(\"Database initialized.\")\n\nuser_tags_metadata = {\"Operations related to users\"}\ntask_tags_metadata = {\"Operations related to tasks\"}\n\napp.include_router(user_router, tags=[user_tags_metadata])\napp.include_router(task_router, tags=[task_tags_metadata])\n</code></pre>"},{"location":"#_2","title":"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u044b","text":"<ul> <li>API \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439: \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0445 \u0442\u043e\u0447\u0435\u043a, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438.</li> <li>API \u0437\u0430\u0434\u0430\u0447: \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a\u043e\u043d\u0435\u0447\u043d\u044b\u0445 \u0442\u043e\u0447\u0435\u043a, \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0441 \u0437\u0430\u0434\u0430\u0447\u0430\u043c\u0438.</li> <li>Models: \u043c\u043e\u0434\u0435\u043b\u044c \u0434\u0430\u043d\u043d\u044b\u0445</li> <li>Schemas: Pydantic-\u0441\u0445\u0435\u043c\u044b</li> </ul>"},{"location":"#_3","title":"(\u043f\u043e\u043a\u0430 \u0432 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435)","text":""},{"location":"#api","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a API","text":"<p>\u0414\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a API \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0431\u044b\u0442\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0442\u043e\u043a\u0435\u043d\u0443 \u0430\u0443\u0442\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043a\u043e\u043d\u0435\u0447\u043d\u0443\u044e \u0442\u043e\u0447\u043a\u0443 <code>/token</code>, \u0430 \u0437\u0430\u0442\u0435\u043c \u0432\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u044d\u0442\u043e\u0442 \u0442\u043e\u043a\u0435\u043d \u0432 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a <code>Authorization</code> \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u043a API.</p>"},{"location":"#_4","title":"\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f","text":""},{"location":"#_5","title":"\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0432\u0441\u0435\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439","text":""},{"location":"models/","title":"\u041c\u043e\u0434\u0435\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 ToDone API","text":"<pre><code>from datetime import datetime, date\nfrom sqlmodel import Field, Relationship, SQLModel\nfrom typing import List, Optional\n\nclass User(SQLModel, table=True):\n    id: Optional[int] = Field(default=None, primary_key=True)\n    username: str = Field(index=True)\n    hashed_password: str\n    password: Optional[str] = Field(default=None, exclude=True)\n    is_active: bool = Field(default=True)\n    tasks: List[\"Task\"] = Relationship(back_populates=\"owner\")\n\nclass TaskCategory(SQLModel, table=True):\n    task_id: int = Field(foreign_key=\"task.id\", primary_key=True)\n    category_id: int = Field(foreign_key=\"category.id\", primary_key=True)\n    additional_info: str\n    task: \"Task\" = Relationship(back_populates=\"task_categories\")\n    category: \"Category\" = Relationship(back_populates=\"category_tasks\")\n\nclass Task(SQLModel, table=True):\n    id: Optional[int] = Field(default=None, primary_key=True)\n    title: str\n    description: str\n    deadline: Optional[date] = None\n    priority: int = Field(default=1)\n    user_id: Optional[int] = Field(default=None, foreign_key=\"user.id\")\n    owner: User = Relationship(back_populates=\"tasks\")\n    task_categories: List[TaskCategory] = Relationship(back_populates=\"task\")\n    time_logs: List[\"TimeLog\"] = Relationship(back_populates=\"task\")\n\nclass Category(SQLModel, table=True):\n    id: Optional[int] = Field(default=None, primary_key=True)\n    name: str\n    category_tasks: List[TaskCategory] = Relationship(back_populates=\"category\")\n\nclass TimeLog(SQLModel, table=True):\n    id: Optional[int] = Field(default=None, primary_key=True)\n    task_id: int = Field(foreign_key=\"task.id\")\n    time_spent_minutes: int\n    date_logged: date\n    task: Task = Relationship(back_populates=\"time_logs\")\n\nmetadata = SQLModel.metadata\n</code></pre>"},{"location":"schemas/","title":"\u0421\u0445\u0435\u043c\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0432\u044b\u0432\u043e\u0434\u0430","text":"<pre><code>from datetime import date\n\nfrom pydantic import BaseModel\nfrom typing import Optional, List\n\n# \u0421\u0445\u0435\u043c\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nclass UserCreate(BaseModel):\n    username: str\n    hashed_password: str\n    is_active: Optional[bool] = True\n\n# \u0421\u0445\u0435\u043c\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u0447\u0442\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nclass UserRead(BaseModel):\n    id: int\n    username: str\n    is_active: bool\n\n# \u0421\u0445\u0435\u043c\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\nclass UserUpdate(BaseModel):\n    username: Optional[str] = None\n    hashed_password: Optional[str] = None\n    is_active: Optional[bool] = None\n\nclass UserLogin(BaseModel):\n    username: str\n    password: str\n\nclass UserList(BaseModel):\n    users: List[UserRead]\n\n\nclass TaskBase(BaseModel):\n    title: str\n    description: str\n    deadline: date\n    priority: int\n    user_id: int\n\nclass TaskCreate(TaskBase):\n    pass\n\nclass TaskUpdate(BaseModel):\n    title: Optional[str] = None\n    description: Optional[str] = None\n    deadline: Optional[date] = None\n    priority: Optional[int] = None\n\nclass Task(TaskBase):\n    id: int\n\n    class Config:\n        orm_mode = True\n\nclass TaskList(BaseModel):\n    tasks: List[Task]\n\nclass TimeLog(BaseModel):\n    id: int\n    task_id: int\n    time_spent_minutes: int\n    date_logged: date\n\n    class Config:\n        orm_mode = True\n\nclass TaskWithTimeLogs(BaseModel):\n    task: Task\n    time_logs: List[TimeLog]\n\nclass TaskWithTimeLogsList(BaseModel):\n    tasks: List[TaskWithTimeLogs]\n</code></pre>"},{"location":"schemas/#_2","title":"\u0422\u0430\u043a\u0436\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445","text":"<pre><code>from datetime import date\n\nfrom sqlalchemy.orm import Session\nimport models\nimport auth, schemas\n\ndef create_user(db: Session, user: schemas.UserCreate):\n    hashed_password = auth.get_password_hash(user.password)  # \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u043f\u0430\u0440\u043e\u043b\u044c \u0445\u044d\u0448\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e\n    db_user = models.User(username=user.username, hashed_password=hashed_password)\n    db.add(db_user)\n    db.commit()\n    db.refresh(db_user)\n    return db_user\n\ndef get_user(db: Session, user_id: int):\n    return db.query(models.User).filter(models.User.id == user_id).first()\n\ndef get_user_by_username(db: Session, username: str):\n    return db.query(models.User).filter(models.User.username == username).first()\n\ndef update_user(db: Session, user_id: int, username: str, hashed_password: str, is_active: bool = True):\n    db_user = db.query(models.User).filter(models.User.id == user_id).first()\n    if db_user:\n        db_user.username = username\n        db_user.hashed_password = hashed_password\n        db_user.is_active = is_active\n        db.commit()\n        db.refresh(db_user)\n        return db_user\n    return None\n\ndef delete_user(db: Session, user_id: int):\n    db_user = db.query(models.User).filter(models.User.id == user_id).first()\n    if db_user:\n        db.delete(db_user)\n        db.commit()\n        return db_user\n    return None\n\ndef get_all_users(db: Session):\n    return db.query(models.User).all()\n\n# \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438\ndef create_task(db: Session, title: str, description: str, deadline: date, priority: int, user_id: int):\n    new_task = models.Task(title=title, description=description, deadline=deadline, priority=priority, user_id=user_id)\n    db.add(new_task)\n    db.commit()\n    db.refresh(new_task)\n    return new_task\n\n# \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043f\u043e \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0443\ndef get_task(db: Session, task_id: int):\n    return db.query(models.Task).filter(models.Task.id == task_id).first()\n\n# \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0441\u0435\u0445 \u0437\u0430\u0434\u0430\u0447\ndef get_all_tasks(db: Session):\n    return db.query(models.Task).all()\n\n# \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438\ndef update_task(db: Session, task_id: int, title: str, description: str, deadline: date, priority: int):\n    task = db.query(models.Task).filter(models.Task.id == task_id).first()\n    if task:\n        task.title = title\n        task.description = description\n        task.deadline = deadline\n        task.priority = priority\n        db.commit()\n        db.refresh(task)\n    return task\n\n# \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438\ndef delete_task(db: Session, task_id: int):\n    task = db.query(models.Task).filter(models.Task.id == task_id).first()\n    if task:\n        db.delete(task)\n        db.commit()\n    return task\n\ndef get_user_tasks(db: Session, user_id: int):\n    return db.query(models.Task).filter(models.Task.user_id == user_id).all()\n\ndef get_user_by_task_id(db: Session, task_id: int):\n    task = db.query(models.Task).filter(models.Task.id == task_id).first()\n    if not task:\n        return None\n    return task.owner\n\ndef get_tasks_with_time_logs(db: Session, task_id: int):\n    task = db.query(models.Task).filter(models.Task.id == task_id).first()\n    if not task:\n        return None\n    return [{\"task\": task, \"time_logs\": task.time_logs}]\n\ndef add_time_log(db: Session, task_id: int, time_spent_minutes: int, date_logged: date):\n    time_log = models.TimeLog(task_id=task_id, time_spent_minutes=time_spent_minutes, date_logged=date_logged)\n    db.add(time_log)\n    db.commit()\n    db.refresh(time_log)\n    return time_log\n\ndef get_time_logs_for_task(db: Session, task_id: int):\n    return db.query(models.TimeLog).filter(models.TimeLog.task_id == task_id).all()\n</code></pre>"},{"location":"task_endpoints/","title":"\u042d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447","text":"<pre><code>from fastapi import APIRouter, Depends, HTTPException, status\nfrom sqlalchemy.orm import Session\nimport models, crud\nfrom connection import get_session\nfrom schemas import *\n\nrouter = APIRouter()\n\n@router.post(\"/tasks/\",\n        response_model=Task,\n        status_code=status.HTTP_201_CREATED,\n        tags=[\"Tasks\"],  # \u0422\u0435\u0433\u0438 \u0434\u043b\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438\n        summary=\"Create a new task\",  # \u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430\n        description=\"Create a new task with the provided data.\",\n        responses={  # \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u043e\u0442\u0432\u0435\u0442\u043e\u0432\n            201: {\"description\": \"Task created successfully\"},\n            400: {\"description\": \"Invalid data provided\"},\n            500: {\"description\": \"Internal server error\"},\n    })\ndef create_task(task_data: TaskCreate, db: Session = Depends(get_session)):\n    return crud.create_task(db=db, **task_data.dict())\n\n@router.get(\"/tasks/{task_id}\", response_model=Task)\ndef read_task(task_id: int, db: Session = Depends(get_session)):\n    db_task = crud.get_task(db, task_id=task_id)\n    if db_task is None:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    return db_task\n\n@router.get(\"/tasks/\", response_model=TaskList)\ndef read_all_tasks(db: Session = Depends(get_session)):\n    tasks = crud.get_all_tasks(db)\n    return {\"tasks\": tasks}\n\n@router.put(\"/tasks/{task_id}\", response_model=Task)\ndef update_task(task_id: int, task_data: TaskUpdate, db: Session = Depends(get_session)):\n    db_task = crud.get_task(db, task_id=task_id)\n    if db_task is None:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    return crud.update_task(db=db, task_id=task_id, **task_data.dict(exclude_unset=True))\n\n@router.delete(\"/tasks/{task_id}\", response_model=Task)\ndef delete_task(task_id: int, db: Session = Depends(get_session)):\n    db_task = crud.get_task(db, task_id=task_id)\n    if db_task is None:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    return crud.delete_task(db=db, task_id=task_id)\n\n@router.get(\"/tasks/user/{user_id}\", response_model=TaskList)\ndef read_user_tasks(user_id: int, db: Session = Depends(get_session)):\n    tasks = crud.get_user_tasks(db, user_id)\n    if not tasks:\n        raise HTTPException(status_code=404, detail=\"User has no tasks\")\n    return {\"tasks\": tasks}\n\n@router.get(\"/tasks/{task_id}/user\", response_model=UserRead)\ndef read_user_by_task_id(task_id: int, db: Session = Depends(get_session)):\n    user = crud.get_user_by_task_id(db, task_id)\n    if not user:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    return user\n\n@router.get(\"/tasks-with-time-logs/{task_id}\", response_model=TaskWithTimeLogsList)\ndef read_tasks_with_time_logs(task_id: int, db: Session = Depends(get_session)):\n    tasks = crud.get_tasks_with_time_logs(db, task_id)\n    if not tasks:\n        raise HTTPException(status_code=404, detail=\"Task not found\")\n    return {\"tasks\": tasks}\n\n@router.post(\"/tasks/{task_id}/add-time-log\")\ndef add_time_log_to_task(task_id: int, time_spent_minutes: int, date_logged: date, db: Session = Depends(get_session)):\n    return crud.add_time_log(db, task_id, time_spent_minutes, date_logged)\n\n@router.get(\"/tasks/{task_id}/time-logs\")\ndef get_time_logs_for_task(task_id: int, db: Session = Depends(get_session)):\n    return crud.get_time_logs_for_task(db, task_id)\n</code></pre>"},{"location":"user_endpoints/","title":"\u042d\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","text":"<pre><code>from fastapi import APIRouter, Depends, HTTPException, status\nfrom fastapi.exceptions import RequestValidationError\nimport jwt\nfrom sqlalchemy.orm import Session\nimport models, crud, auth, schemas\nfrom connection import get_session\nfrom schemas import *\nimport auth\n\nrouter = APIRouter()\n\n@router.post(\"/register\", response_model=schemas.UserCreate)\ndef register_user(user: schemas.UserCreate, db: Session = Depends(get_session)):\n    db_user = crud.get_user_by_username(db, username=user.username)\n    if db_user:\n        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail=\"Username already registered\")\n    return auth.create_user(db=db, user=user)\n\n@router.post(\"/login\")\ndef login_user(user: schemas.UserLogin, db: Session = Depends(get_session)):\n    try:\n        authenticated_user = auth.authenticate_user(db=db, username=user.username, password=user.password)\n        if not authenticated_user:\n            raise HTTPException(status_code=status.HTTP_401_UNAUTHORIZED, detail=\"Invalid username or password\")\n        access_token = auth.create_access_token(data={\"sub\": authenticated_user.username})\n        return {\"access_token\": access_token, \"token_type\": \"bearer\"}\n    except RequestValidationError as e:\n        raise HTTPException(status_code=422, detail=\"Validation error\", headers=e.headers)\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\nasync def get_current_user(db: Session = Depends(get_session), token: str = Depends(auth.oauth2_scheme)):\n    credentials_exception = HTTPException(\n        status_code=status.HTTP_401_UNAUTHORIZED,\n        detail=\"Could not validate credentials\",\n        headers={\"WWW-Authenticate\": \"Bearer\"},\n    )\n    try:\n        payload = jwt.decode(token, auth.SECRET_KEY, algorithms=[auth.ALGORITHM])\n        username: str = payload.get(\"sub\")\n        if username is None:\n            raise credentials_exception\n    except jwt.JWTError:\n        raise credentials_exception\n    user = crud.get_user_by_username(db, username)\n    if user is None:\n        raise credentials_exception\n    return user\n\n@router.post(\"/users/\",\n             response_model=UserRead,\n             status_code=status.HTTP_201_CREATED,\n             tags=[\"Users\"],  # \u0422\u0435\u0433\u0438 \u0434\u043b\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u0438\n             summary=\"Create a new user\",  # \u041a\u0440\u0430\u0442\u043a\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u0430\n             description=\"Create a new user with the provided data.\",\n             responses={  # \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u043e\u0442\u0432\u0435\u0442\u043e\u0432\n                 201: {\"description\": \"User created successfully\"},\n                 400: {\"description\": \"Invalid data provided\"},\n                 409: {\"description\": \"User with this username already exists\"},\n                 500: {\"description\": \"Internal server error\"},\n             }\n             )\ndef create_user(user_data: UserCreate, db: Session = Depends(get_session)):\n    return crud.create_user(db=db, **user_data.dict())  # \u0420\u0430\u0441\u043f\u0430\u043a\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0441\u0445\u0435\u043c\u044b UserCreate\n\n@router.get(\"/users/{user_id}\", response_model=UserRead)  # \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c, \u0447\u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c - UserRead\ndef read_user(user_id: int, db: Session = Depends(get_session)):\n    db_user = crud.get_user(db, user_id=user_id)\n    if db_user is None:\n        raise HTTPException(status_code=404, detail=\"User not found\")\n    return db_user\n\n@router.put(\"/users/{user_id}\", response_model=UserRead)  # \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c, \u0447\u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c - UserRead\ndef update_user(user_id: int, user_data: UserUpdate, db: Session = Depends(get_session)):\n    return crud.update_user(db=db, user_id=user_id, **user_data.dict(exclude_unset=True))  # \u0420\u0430\u0441\u043f\u0430\u043a\u043e\u0432\u044b\u0432\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0441\u0445\u0435\u043c\u044b UserUpdate, \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044f \u043f\u0443\u0441\u0442\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\n\n@router.delete(\"/users/{user_id}\", response_model=UserRead)  # \u0423\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c, \u0447\u0442\u043e \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c - UserRead\ndef delete_user(user_id: int, db: Session = Depends(get_session)):\n    return crud.delete_user(db=db, user_id=user_id)\n\n@router.get(\"/users/\", response_model=UserList)\ndef read_users(db: Session = Depends(get_session)):\n    users = crud.get_all_users(db)\n    return {\"users\": users}\n</code></pre>"}]}